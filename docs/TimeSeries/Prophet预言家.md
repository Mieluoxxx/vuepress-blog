---
title: Prophet预言家模型
---

> prophet是facebook在2017年开源的强大的时间序列预测工具。

Prophet是一个设计精妙的单层的回归模型，**特别适合对具有明显季节周期性(如气温，商品销量，交通流量等)的时间序列进行预测**，并具有强大的解释性。

我们将简要介绍Prophet框架的算法原理，并以一个开源的能源消耗时间序列数据预测为例，展示prophet的使用方法和强大能力

**1. prophet的优点：**

1. 拟合能力强。可以拟合时间序列数据中的趋势特性，周期特性，以及节假日时间/特殊事件影响等，可以返回置信区间作为预测结果。

2. 对噪声鲁棒。趋势项中引入了changepoints，模型的参数量远远小于lstm等深度方案，不容易过拟合，收敛迅速。

3. 模型解释性好。提供了强大的可视化分析辅助工具，便于分析趋势，不同周期，不同节假日/特殊事件 各自的贡献。

**2. prophet的缺点：**

1，不适用协变多维序列。prophet仅仅能够对单个时间序列建模(例如某地气温)，不能够对协变的多个序列同时建模(例如沪深300支股票走势)。

2，无法进行自动化复杂特征抽取。受prophet模型相对简单的假设空间的限制，它无法对输入特征进行交叉组合变换等自动化抽取操作。

**3，prophet的原理：**

prophet是一个加法模型，将时间序列分解成 趋势项，周期项，节假日项/特殊事件影响，以及残差项的组合。
$$
y(t)=g(t)+s(t)+h(t)+\epsilon_t
$$
【注：根据需要，也可以将 周期项 和 节假日项/特殊事件影响 设置为乘数，而非加数】

1，其中趋势项被拟合成 分段线性函数(默认) 或者 分段logistic函数(存在上下限的情形，如虫口模型，病毒传播等存在容量上限)。

2，周期项使用有限阶(通常对一个是3到8阶)的傅里叶级数进行拟合，大大减少了参数量，避免对噪声数据过拟合。

3，节假日项/特殊事件项 可以作为点特征或者区间特征引入，并支持自定义不同类型的节假日或事件，还可通过add_regressor引入其它已知序列作为特征，非常灵活。

